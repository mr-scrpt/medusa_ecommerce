# План реализации функционала "Атрибуты товаров"

## Текущий статус (24.08.2025)

Отлично реализована основа:
- **Модуль `attributes`**: Созданы модели `Attribute` и `AttributeValue`, а также сервис для управления ими.
- **Workflows**: Реализован воркфлоу для создания атрибутов и их значений.
- **API**: Существует эндпоинт для создания и получения атрибутов.
- **Связи (Links)**: Корректно определены связи "многие-ко-многим" между:
    - `ProductCategory` и `Attribute`
    - `Product` и `AttributeValue`

## Следующие шаги: Реализация API

Текущая задача - создать API (эндпоинты), которые позволят управлять созданными связями.

### Шаг 1: API для управления связью "Категория <-> Атрибут"

**Цель**: Дать возможность администратору привязывать атрибуты к категориям товаров.

**План**:
1.  Создать файл: `src/api/admin/categories/[id]/attributes/route.ts`.
2.  Реализовать в нем следующие методы:
    - **`GET /admin/categories/:id/attributes`**: Возвращает список всех атрибутов, привязанных к категории с `:id`.
    - **`POST /admin/categories/:id/attributes`**: Привязывает новый атрибут к категории. В теле запроса ожидается `attribute_id`.
    - **`DELETE /admin/categories/:id/attributes/:attribute_id`**: Отвязывает атрибут (`:attribute_id`) от категории (`:id`).

### Шаг 2: API для управления связью "Товар <-> Значение атрибута"

**Цель**: Дать возможность администратору выбирать значения атрибутов для конкретного товара.

**План**:
1.  Создать файл: `src/api/admin/products/[id]/attributes/route.ts`.
2.  Реализовать в нем следующие методы:
    - **`GET /admin/products/:id/attributes`**: Более сложный эндпоинт, который должен:
        - Определить категорию товара (`:id`).
        - Вернуть список всех атрибутов, доступных для этой категории.
        - Для каждого атрибута вернуть список его возможных значений (`AttributeValue`).
        - Отметить те значения, которые уже выбраны для данного товара.
    - **`POST /admin/products/:id/attributes`**: Сохраняет или обновляет набор выбранных значений атрибутов для товара (`:id`). В теле запроса ожидается массив ID значений, например: `{ "values": ["value_id_1", "value_id_2"] }`.

## Завершающий этап: Интеграция с Админ-панелью

После реализации API, необходимо будет кастомизировать админ-панель Medusa:

1.  **Страница редактирования категории**: Добавить интерфейс для выбора атрибутов, которые будут доступны для товаров в этой категории.
2.  **Страница редактирования товара**: Добавить динамический интерфейс, который будет на основе категории товара отображать доступные атрибуты и позволять выбирать их значения (например, в виде выпадающих списков, чекбоксов и т.д.).
